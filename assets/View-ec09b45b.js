import{a as s,j as e,F as E}from"./jsx-runtime-670450c2.js";import{r as o}from"./index-f1f749bf.js";import{p as y}from"./index-4d501b15.js";import{u as I,C as T}from"./store-0ad8816f.js";import{u as F}from"./useVisConfig-4fe3448c.js";import{B as J}from"./Button-f99151a1.js";import{I as R}from"./Icon-e6436e69.js";import{S as H}from"./SplashError-5cc7fe2a.js";import{O as q}from"./Overlay-8b705bae.js";/* empty css             */const N=["360","480","768","960","1170","1280"];const K=({editorPanels:g,children:h})=>{var P,z;const{config:i,updateVisConfig:S}=F(),f=I(t=>t.os),[a,v]=o.useState(!0),[c,n]=o.useState(!1),[r,b]=o.useState(null),[m,w]=o.useState(!1),[u,_]=o.useState(!1),[x,W]=o.useState({}),p=o.useRef(null),C=o.useRef(null),k=o.useRef(null),A=()=>{let t=JSON.parse(JSON.stringify(i));return delete t.newViz,t};o.useEffect(()=>(document.addEventListener("keydown",D),()=>document.removeEventListener("keydown",D)),[]),o.useEffect(()=>n(!!r),[r]),o.useEffect(()=>{i.missingRequiredSections===!0&&_(!0),i.missingRequiredSections===!1&&u===!0&&_(!1)},[i.missingRequiredSections,u]),o.useEffect(()=>{u===!1&&S(A())},[u]);const M=o.useCallback(t=>b(d=>d!==t?t:null),[r]),D=t=>{t.code==="Escape"&&v(l=>!l);const d=f==="MacOS"?t.metaKey:t.altKey;if(d){let l=t.key;isNaN(l)||l<=N.length&&(t.preventDefault(),M(N[l-1]))}d||C.current&&!C.current.contains(document.activeElement)&&(t.code==="KeyG"&&n(l=>!l),t.code==="KeyR"&&V())};o.useEffect(()=>{if(!k.current)return;let t=new ResizeObserver(d=>{for(let l of d){let{width:$,height:j}=l.contentRect;W({width:$,height:j})}});return t.observe(k.current),()=>{t&&(t.disconnect(),t=null)}},[]);const B=()=>v(!a),L=()=>{const t=()=>_(!1);return e("section",{className:"cove-splash__waiting",children:s("section",{className:"cove-splash__waiting__container",children:[e("h3",{children:"Finish Configuring"}),e("p",{children:"Set all required options to the left and confirm below to display the preview."}),e(J,{className:"mt-2 mx-auto",disabled:i.missingRequiredSections,onClick:()=>t(),children:"I'm Done"})]})})},V=o.useCallback(()=>{if(!m&&p.current){b(null),w(!0),n(!1),p.current.style.transition="transform 800ms cubic-bezier(0.16, 1, 0.3, 1)",p.current.style.transform="rotate(-360deg)";const t=setTimeout(()=>{w(!1),p.current.style.transition=null,p.current.style.transform="rotate(0deg)",p.current.style.transform=null},400);return()=>clearTimeout(t)}},[m]);let O=e(E,{children:h});return g&&(O=s("div",{className:`cove-editor${a?" panel-shown":""}`,children:[e("button",{className:"cove-editor__toggle"+(a?"":" collapsed"),title:a?"Collapse Editor":"Expand Editor",onClick:B}),s("section",{className:"cove-editor__panel",tabIndex:0,ref:C,children:[s("h2",{className:"cove-editor__panel-heading","aria-level":"2",role:"heading",children:["Configure ",i.type?T.String.convertKebabToTitle(i.type):"Component"]}),e("div",{className:"cove-editor__panel-container",children:e("section",{className:"cove-editor__panel-config",children:g})})]}),s("div",{className:"cove-editor__content","data-grid":c||null,children:[u&&e(L,{}),e("div",{className:"cove-editor__content-wrap--x",style:r?{maxWidth:r+"px",minWidth:"unset"}:null,children:s("div",{className:"cove-editor__content-wrap--y",children:[e("div",{className:"cove-editor-utils__breakpoints--px",children:c&&a&&s(E,{children:[Math.round(x.width),e("span",{className:"mx-1",style:{fontSize:"0.675rem"},children:"âœ•"}),Math.round(x.height)]})}),e("div",{className:"cove-editor__grid-caret--top",ref:k,children:s("div",{className:"cove-editor__grid-caret--bottom",children:[(i==null?void 0:i.newViz)===void 0&&((P=i==null?void 0:i.runtime)==null?void 0:P.editorErrorMessage)&&((z=i==null?void 0:i.runtime)==null?void 0:z.editorErrorMessage.length)>0&&e(H,{title:"Error With Configuration",message:i.runtime.editorErrorMessage}),h]})})]})}),s("div",{className:"cove-editor-utils__hotkeys",children:[s("div",{className:"cove-editor-utils__hotkeys--left",children:[e("p",{className:a?"hotkey--active":null,children:"Editor"}),e("p",{className:c?"hotkey--active":null,children:"Grid"}),e("p",{className:m?"hotkey--active":null,children:"Reset"}),e("p",{className:r?"hotkey--active":null,children:"View"})]}),s("div",{className:"cove-editor-utils__hotkeys--right",children:[e("p",{className:a?"hotkey--active":null,children:"esc"}),e("p",{className:c?"hotkey--active":null,children:"G"}),e("p",{className:m?"hotkey--active":null,children:"R"}),s("p",{className:r?"hotkey--active":null,children:[f==="MacOS"?e(R,{style:{marginRight:"0.25rem"},display:"command",size:12}):"Alt"," + ",r?N.indexOf(r)+1:`[1 - ${N.length}]`]})]})]}),e("div",{className:"cove-editor-utils__breakpoints",children:s("ul",{className:`cove-editor-utils__breakpoints-list${r?" has-active":""}`,children:[e("li",{className:"cove-editor-utils__breakpoints-item",onClick:()=>{n(t=>!t)},children:e("div",{className:"cove-editor-utils__breakpoints-grid",children:e(R,{display:"squareGrid"})})}),N.map((t,d)=>s("li",{className:`cove-editor-utils__breakpoints-item${r===t?" active":""}`,onClick:()=>M(t),children:[t,"px"]},d)),e("li",{className:"cove-editor-utils__breakpoints-item",onClick:()=>{V()},children:e("div",{className:"cove-editor-utils__breakpoints-reset",ref:p,children:e(R,{display:"rotateLeft"})})})]})})]})]})),O};K.__docgenInfo={description:"",methods:[],displayName:"Editor"};const G=({editorPanels:g,isPreview:h,children:i})=>{const{viewMode:S,setViewMode:f,setViewport:a}=I(),v=window.location.href;o.useEffect(()=>{const w=new ResizeObserver(u=>{const{width:_}=u[0].contentRect;a(T.General.getViewport(_))});return w.observe(document.documentElement),()=>w.disconnect()},[]),o.useEffect(()=>(v.includes("editor=true")&&f("isEditor",!0),()=>{}),[v,f]);const{isEditor:c,isDashboard:n,isWizard:r}=S,b=o.useRef(),m=o.useCallback(()=>c&&!n&&!r||c&&n&&!h||r?e(K,{editorPanels:g,children:i}):e(E,{children:i}),[c,n,r,h]);return n||r?s(E,{children:[e(m,{}),e(q,{})]}):s("div",{className:"cove",ref:b,children:[e(m,{}),e(q,{})]})};G.propTypes={"viewMode.isEditor":y.bool,"viewMode.isDashboard":y.bool,"viewMode.isPreview":y.bool,"viewMode.isWizard":y.bool,EditorPanels:y.func};G.__docgenInfo={description:"",methods:[],displayName:"View",props:{"viewMode.isEditor":{type:{name:"bool"},required:!1,description:"**[External]** Defined in the `globalStore` - Sets the Editor view mode for the component"},"viewMode.isDashboard":{type:{name:"bool"},required:!1,description:"**[External]** Defined in the `globalStore` - Sets the Dashboard view mode for the component"},"viewMode.isPreview":{type:{name:"bool"},required:!1,description:"**[External]** Defined in the `globalStore` - Sets the Dashboard's Preview view mode for the component"},"viewMode.isWizard":{type:{name:"bool"},required:!1,description:"**[External]** Defined in the `globalStore` - Sets the Wizard view mode for the component"},EditorPanels:{type:{name:"func"},required:!1,description:"The React component export of the EditorPanels for the component"}}};export{G as V};
//# sourceMappingURL=View-ec09b45b.js.map
