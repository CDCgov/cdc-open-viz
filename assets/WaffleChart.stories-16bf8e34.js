import{M as ce,C as de,S as me,A as ue}from"./index-a5c7af6f.js";import{a as m,j as a,F as O}from"./jsx-runtime-670450c2.js";import{r as _,R as k}from"./index-f1f749bf.js";import{u as ee,V as fe}from"./useVisConfig-ed2d617d.js";import{C as pe}from"./Component-539a22b1.js";import{E as he}from"./ErrorBoundary-d4835eb6.js";import{R as be}from"./RenderFallback-55155a13.js";import{V as ge}from"./View-6c4b1f1d.js";import{C as c,u as Ce}from"./store-4dc22f46.js";import{A as y}from"./Accordion-e4e11532.js";import{P as ve,a as Ne}from"./Panel.Component.Filters-dcd859a7.js";import{I as De}from"./InputCheckbox-ed81a1d9.js";import{I as C}from"./InputSelect-c989da31.js";import{I as g}from"./InputText-4a90025a.js";import{L as X}from"./Label-a6b7661b.js";import{S as B}from"./SectionWrapper-7bea3889.js";import{h as K}from"./Tooltip-2e67733b.js";import{a as Se}from"./ColorPicker-7e2324e3.js";import{p as v}from"./index-4d501b15.js";import{u as Q}from"./index-4fb8b842.js";import"./iframe-9bfe7737.js";import"../sb-preview/runtime.mjs";import"./index-6e91e324.js";import"./index-d475d2ea.js";import"./index-c46f0053.js";import"./_commonjsHelpers-042e6b4d.js";import"./index-d37d4223.js";import"./index-356e4a49.js";import"./Icon-84bbcad3.js";import"./LoadSpin-71c660ed.js";import"./Button-f99151a1.js";import"./SplashError-3dba32c8.js";import"./Overlay-ac400bb9.js";/* empty css             */import"./InputToggle-9134993b.js";/* empty css              */import"./SectionBlock-e9ce0bd2.js";const _e={title:"Waffle Chart",content:"",subtext:"",orientation:"horizontal",data:"",filters:[],fontSize:"",overallFontSize:"medium",dataColumn:"",dataFunction:"",dataConditionalColumn:"",dataConditionalOperator:"",dataConditionalComparate:"",invalidComparate:!1,customDenom:!1,dataDenom:"100",dataDenomColumn:"",dataDenomFunction:"",suffix:"%",roundToPlace:"0",shape:"circle",nodeWidth:"10",nodeSpacer:"2",theme:"blue",type:"waffle-chart",visual:{border:"default",accent:"none",background:"default",shadow:!0},missingRequiredSections:!1},z="Count",w="Max",j="Mean (Average)",W="Median",I="Min",L="Mode",U="Sum",Z=[z,w,j,W,I,L,U],Oe="<",ye=">",xe="<=",Te=">=",Ae="=",Fe="≠",Re=[Oe,ye,xe,Te,Ae,Fe],ae=()=>{const{config:e,updateVisConfigField:o}=ee(),{data:t}=e;_.useEffect(()=>{let p=["<",">","<=",">="];e.dataConditionalComparate!==""?p.indexOf(e.dataConditionalOperator)>-1&&isNaN(e.dataConditionalComparate)?o("invalidComparate",!0):e.invalidComparate&&o("invalidComparate",!1):o("invalidComparate",!1)},[e.dataConditionalOperator,e.dataConditionalComparate]);const n=m(y.Section,{label:"General",children:[a(g,{label:"Title",placeholder:"Waffle Chart Title",configField:"title"}),a(g,{label:"Message",type:"textarea",configField:"content",tooltip:"Enter the message text for the visualization. The following HTML tags are supported: strong, em, sup, and sub."}),a(g,{label:"Subtext/Citation",placeholder:"Waffle Chart Subtext or Citation",configField:"subtext",tooltip:"Enter supporting text to display below the data visualization, if applicable. The following HTML tags are supported: strong, em, sup, and sub."})]}),r=m(y.Section,{label:"Data",warnIf:!c.General.isValid(e.dataColumn)||!c.General.isValid(e.dataFunction),children:[m(B,{label:"Numerator",children:[a(C,{label:"Data Column",options:c.Data.getDataColumns(t),configField:"dataColumn",initialDisabled:!0,required:!0}),a(C,{label:"Data Function",options:Z,configField:"dataFunction",initialDisabled:!0,required:!0}),a(X,{children:"Data Conditional"}),m("div",{className:"cove-grid cove-grid--gap--2 mb-3",children:[a("div",{className:"cove-grid__col--4",children:a(C,{className:"mb-0",options:c.Data.getDataColumns(t),configField:"dataConditionalColumn",initialDisabled:!0})}),a("div",{className:"cove-grid__col--4",children:a(C,{className:"mb-0",options:Re,configField:"dataConditionalOperator",initialDisabled:!0})}),a("div",{className:"cove-grid__col--4",children:a(g,{className:"mb-0",configField:"dataConditionalComparate"})})]}),e.invalidComparate&&a("div",{className:"accordion__panel-error",children:"Non-numerical comparate values can only be used with = or ≠."})]}),m(B,{label:"Denominator",children:[a(De,{label:"Select from data",size:"small",configField:"customDenom"}),!e.customDenom&&m("div",{className:"cove-grid cove-grid--gap--2 mb-3",children:[a("div",{className:"cove-grid__col--6",children:a(g,{className:"mb-0",configField:"dataDenom"})}),a("div",{className:"cove-grid__col--6",children:a("small",{children:"default (100)"})})]}),e.customDenom&&m(O,{children:[a(C,{label:"Data Column",options:c.Data.getDataColumns(t),configField:"dataDenomColumn"}),a(C,{label:"Data Function",options:Z,configField:"dataDenomFunction"})]})]}),a("hr",{className:"cove-editor__divider"}),m("div",{className:"cove-grid cove-grid--gap--2 mb-3",children:[a("div",{className:"cove-grid__col--4",children:a(g,{label:"Prefix",className:"mb-0",configField:"prefix"})}),a("div",{className:"cove-grid__col--4",children:a(g,{label:"Suffix",className:"mb-0",configField:"suffix"})}),a("div",{className:"cove-grid__col--4",children:a(g,{label:"Round",className:"mb-0",type:"number",configField:"roundToPlace"})})]})]}),i=a(y.Section,{label:"Filters",children:a(ve,{})}),u=m(y.Section,{label:"Visual",children:[a(C,{label:"Shape",options:["circle","square","person"],configField:"shape"}),m("div",{className:"cove-grid cove-grid--gap--2 mb-3",children:[a("div",{className:"cove-grid__col--6",children:a(g,{label:"Width",className:"mb-0",type:"number",configField:"nodeWidth"})}),a("div",{className:"cove-grid__col--6",children:a(g,{label:"Spacer",className:"mb-0",type:"number",configField:"nodeSpacer"})})]}),a(C,{label:"Layout",options:["horizontal","vertical"],configField:"orientation"}),a(X,{tooltip:"Change the font size of the output value returned from the Data",children:"Data Value Font Size"}),m("div",{className:"cove-grid cove-grid--gap--2 mb-3",children:[a("div",{className:"cove-grid__col--6",children:a(g,{className:"mb-0",type:"number",configField:"fontSize"})}),a("div",{className:"cove-grid__col--6",style:{display:"flex",alignItems:"center"},children:a("small",{children:"default (50px)"})})]}),a(C,{label:"Overall Font Size",tooltip:"Change the overall font size of the entire component.",options:["small","medium","large"],configField:"overallFontSize"})]});return a(O,{children:m(y,{children:[n,r,i,u,Ne]})})};ae.__docgenInfo={description:"",methods:[],displayName:"EditorPanels"};var q={},Me={get exports(){return q},set exports(e){q=e}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(e){(function(){var o={}.hasOwnProperty;function t(){for(var n=[],r=0;r<arguments.length;r++){var i=arguments[r];if(i){var u=typeof i;if(u==="string"||u==="number")n.push(i);else if(Array.isArray(i)){if(i.length){var p=t.apply(null,i);p&&n.push(p)}}else if(u==="object"){if(i.toString!==Object.prototype.toString&&!i.toString.toString().includes("[native code]")){n.push(i.toString());continue}for(var h in i)o.call(i,h)&&i[h]&&n.push(h)}}}return n.join(" ")}e.exports?(t.default=t,e.exports=t):window.classNames=t})()})(Me);const G=q;var Pe=["className","innerRef"];function $(){return $=Object.assign?Object.assign.bind():function(e){for(var o=1;o<arguments.length;o++){var t=arguments[o];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},$.apply(this,arguments)}function Ee(e,o){if(e==null)return{};var t={},n=Object.keys(e),r,i;for(i=0;i<n.length;i++)r=n[i],!(o.indexOf(r)>=0)&&(t[r]=e[r]);return t}function ze(e){var o=e.className,t=e.innerRef,n=Ee(e,Pe);return k.createElement("rect",$({ref:t,className:G("visx-bar",o)},n))}var we=["className","innerRef"];function V(){return V=Object.assign?Object.assign.bind():function(e){for(var o=1;o<arguments.length;o++){var t=arguments[o];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},V.apply(this,arguments)}function je(e,o){if(e==null)return{};var t={},n=Object.keys(e),r,i;for(i=0;i<n.length;i++)r=n[i],!(o.indexOf(r)>=0)&&(t[r]=e[r]);return t}function We(e){var o=e.className,t=e.innerRef,n=je(e,we);return k.createElement("circle",V({ref:t,className:G("visx-circle",o)},n))}var Ie=["top","left","transform","className","children","innerRef"];function Y(){return Y=Object.assign?Object.assign.bind():function(e){for(var o=1;o<arguments.length;o++){var t=arguments[o];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},Y.apply(this,arguments)}function Le(e,o){if(e==null)return{};var t={},n=Object.keys(e),r,i;for(i=0;i<n.length;i++)r=n[i],!(o.indexOf(r)>=0)&&(t[r]=e[r]);return t}function te(e){var o=e.top,t=o===void 0?0:o,n=e.left,r=n===void 0?0:n,i=e.transform,u=e.className,p=e.children,h=e.innerRef,x=Le(e,Ie);return k.createElement("g",Y({ref:h,className:G("visx-group",u),transform:i||"translate("+r+", "+t+")"},x),p)}te.propTypes={top:v.number,left:v.number,transform:v.string,className:v.string,children:v.node,innerRef:v.oneOfType([v.string,v.func,v.object])};const Ue=e=>{const o=_.useRef();return _.useEffect(()=>{o.current=e},[e]),o.current};function J(e,o,t,n,r){let i=o==="x"?9-t%10:o==="y"?Math.floor(t/10):null;return e==="circle"?i*(n+r)+n/2:i*(n+r)}const E=(e,o,t)=>{if(t){const r=Math.abs(o-t);if(t>o){let i="";const u=Math.abs(t-e-r);return e>o&&e<t&&(i="fill-opacity 200ms cubic-bezier(0.16, 1, 0.3, 1) "+(u*.0025).toString()+"s, "),i}if(t<o){let i="";const u=Math.abs(t-e);return e>=t&&e<o&&(i="fill-opacity 200ms cubic-bezier(0.16, 1, 0.3, 1) "+(Math.abs(r-u)*.0025).toString()+"s, "),i}}return""},oe=()=>{const{config:e,visualizationKey:o}=ee(),{setMissingRequiredSections:t}=Ce(),{data:n}=e,r=_.useCallback(()=>[e.dataColumn,e.dataFunction],[e]);_.useEffect(()=>(r&&e&&t(o,!r().every(d=>!!c.General.isValid(d))),()=>{}),[e,r,t,o]);const i=()=>{if(!(e!=null&&e.dataColumn)||!e.dataFunction)return"";let d=n;e.filters.map(l=>(l.columnName&&l.columnValue&&(d=d.filter(function(S){return S[l.columnName]===l.columnValue})),!1));let f=[];if(e.dataConditionalColumn!==""&&e.dataConditionalOperator!==""&&e.dataConditionalComparate!=="")switch(e.dataConditionalOperator){case"<":f=d.filter(l=>l[e.dataConditionalColumn]<e.dataConditionalComparate);break;case">":f=d.filter(l=>l[e.dataConditionalColumn]>e.dataConditionalComparate);break;case"<=":f=d.filter(l=>l[e.dataConditionalColumn]<=e.dataConditionalComparate);break;case">=":f=d.filter(l=>l[e.dataConditionalColumn]>=e.dataConditionalComparate);break;case"=":isNaN(Number(e.dataConditionalComparate))?f=d.filter(l=>String(l[e.dataConditionalColumn])===e.dataConditionalComparate):f=d.filter(l=>l[e.dataConditionalColumn]===e.dataConditionalComparate);break;case"≠":isNaN(Number(e.dataConditionalComparate))?f=d.filter(l=>String(l[e.dataConditionalColumn])!==e.dataConditionalComparate):f=d.filter(l=>l[e.dataConditionalColumn]!==e.dataConditionalComparate);break;default:f=[]}const s=f.length>0?f.map(l=>l[e.dataColumn]):d.map(l=>l[e.dataColumn]),b=d.map(l=>l[e.dataDenomColumn]);let N=s.filter(l=>{let S=!1;return(Number(l)||Number.isFinite(Number(l)))&&(S=!0),S}).map(Number),D=b.filter(l=>{let S=!1;return(Number(l)||Number.isFinite(Number(l)))&&(S=!0),S}).map(Number),H="";H={[z]:String(N.length),[U]:String(c.Number.roundToPlace(c.Math.getSum(N),e.roundToPlace)),[j]:String(c.Number.roundToPlace(c.Math.getMean(N),e.roundToPlace)),[W]:c.Number.roundToPlace(c.Math.getMedian(N).toString(),e.roundToPlace),[w]:Math.max(...N).toString(),[I]:Math.min(...N).toString(),[L]:c.Math.getMode(N).join(", ")}[e.dataFunction];let P=null;const se={[z]:String(D.length),[U]:String(c.Number.roundToPlace(c.Math.getSum(D),e.roundToPlace)),[j]:String(c.Number.roundToPlace(c.Math.getMean(D),e.roundToPlace)),[W]:c.Number.roundToPlace(c.Math.getMedian(D).toString(),e.roundToPlace),[w]:Math.max(...D).toString(),[I]:Math.min(...D).toString(),[L]:c.Math.getMode(D).join(", ")};return e.customDenom&&e.dataDenomColumn&&e.dataDenomFunction?P=se[e.dataDenomFunction]:P=e.dataDenom>0?e.dataDenom:100,c.Number.roundToPlace(H/P*100,e.roundToPlace)},u=()=>e.nodeWidth*10+e.nodeSpacer*9,p=i();let h=parseInt(e.nodeWidth,10),x=parseInt(e.nodeSpacer,10),R=Ue(p),M=p;const re=_.useCallback(()=>{var f;let d=[];for(let s=0;s<100;s++){let b={shape:e.shape,x:J(e.shape,"x",s,h,x),y:J(e.shape,"y",s,h,x),color:(f=Se[e.theme])==null?void 0:f.primary,opacity:s+1>100-Math.round(p)?1:.35};d.unshift(b)}return d.map((s,b)=>s.shape==="square"?a(ze,{className:"cove-waffle-chart__node",style:{transition:E(b,R,M)+"fill 200ms ease 0s",fillOpacity:s.opacity},x:s.x,y:s.y,width:h,height:h,fill:s.color},b):s.shape==="person"?a("path",{style:{transform:`translateX(${s.x+h/4}px) translateY(${s.y}px) scale(${h/20})`,transition:E(b,R,M)+"fill 200ms ease 0s",fillOpacity:s.opacity},fill:s.color,fillOpacity:s.opacity,d:`M3.75,0a2.5,2.5,0,1,1-2.5,2.5A2.5,2.5,0,0,1,3.75,0M5.625,5.625H5.18125a3.433,3.433,0,0,1-2.8625,0H1.875A1.875,1.875,
                          0,0,0,0,7.5v5.3125a.9375.9375,0,0,0,.9375.9375h.625v5.3125A.9375.9375,0,0,0,2.5,20H5a.9375.9375,0,0,0,
                          .9375-.9375V13.75h.625A.9375.9375,0,0,0,7.5,12.8125V7.5A1.875,1.875,0,0,0,5.625,5.625Z`},b):a(We,{className:"cove-waffle-chart__node",style:{transition:E(b,R,M)+"fill 200ms ease 0s",fillOpacity:s.opacity},cx:s.x,cy:s.y,r:h/2,fill:s.color,"data-step":b},b))},[e]);let le=e.fontSize?{fontSize:e.fontSize+"px"}:null;return m(O,{children:[e.missingRequiredSections&&a(O,{children:"Missing data in sections"}),e.missingRequiredSections===!1&&a(O,{children:m("div",{className:`cove-waffle-chart__container${e.orientation==="vertical"?" cove-waffle-chart__container--verical":""}${e.overallFontSize?" font-"+e.overallFontSize:""}`,children:[a("div",{className:"cove-waffle-chart__visualization",style:{width:u()},children:a("svg",{width:u(),height:u(),children:a(te,{children:re()})})}),(p||e.content)&&m("div",{className:"cove-waffle-chart__data",children:[p&&m("div",{className:"cove-waffle-chart__data--primary",style:le,children:[e.prefix?e.prefix:null,p,e.suffix?e.suffix:null]}),a("div",{className:"cove-waffle-chart__data--text",children:K(e.content)})]})]})}),e.subtext&&a("div",{className:"cove-waffle-chart__subtext",children:K(e.subtext)})]})};oe.__docgenInfo={description:"",methods:[],displayName:"WaffleChart"};const A=e=>a(he,{component:"CdcWaffleChart",children:a(_.Suspense,{fallback:a(be,{}),children:a(fe,{...e,defaultConfig:_e,children:a(ge,{editorPanels:a(ae,{}),children:a(pe,{className:"cove-waffle-chart",children:a(oe,{})})})})})});A.__docgenInfo={description:"",methods:[],displayName:"CdcWaffleChart"};const ne=e=>a(A,{config:{...e}}),ie={header:{table:{disable:!0}},content:{table:{disable:!0}},footer:{table:{disable:!0}},shape:{options:["square","circle","person"],control:{type:"radio"}},headerBgColor:{control:{type:"color"}},showDividerTop:{control:{type:"boolean"}},showDividerBottom:{control:{type:"boolean"}},showClose:{control:{type:"boolean"}}};function qe(e={}){const{wrapper:o}=Object.assign({},Q(),e.components);return o?a(o,{...e,children:a(t,{})}):t();function t(){const n=Object.assign({h1:"h1",p:"p"},Q(),e.components);return m(O,{children:[a(ce,{title:"Visualizations/Waffle Chart",component:A}),`
`,`
`,a(n.h1,{children:"Waffle Chart"}),`
`,a(n.p,{children:"The Waffle Chart is a component that displays a grid of squares, each representing a value."}),`
`,a(de,{children:a(me,{name:"Default",args:{shape:"square",title:"Overdose Mortality Rates",content:"of overdoses resulted in death.",subtext:"This data is an example and does not reflect actual averages",orientation:"horizontal",data:[{"Resulted in Death":250,"Number of Overdoses":600,state:"Alabama",Year:"2010"},{"Resulted in Death":16,"Number of Overdoses":80,state:"Alaska",Year:"2008"},{"Resulted in Death":19,"Number of Overdoses":100,state:"Alaska",Year:"2010"},{"Resulted in Death":93,"Number of Overdoses":400,state:"Alaska",Year:"2012"},{"Resulted in Death":82,"Number of Overdoses":400,state:"Arizona",Year:"2010"}],filters:[],fontSize:null,overallFontSize:"medium",dataColumn:"Resulted in Death",dataFunction:"Sum",dataConditionalColumn:"",dataConditionalOperator:null,dataConditionalComparate:"",customDenom:!0,dataDenom:null,dataDenomColumn:"Number of Overdoses",dataDenomFunction:"Sum",prefix:"",suffix:"%",roundToPlace:0,nodeWidth:10,nodeSpacer:2,theme:"blue"},argTypes:ie,children:ne.bind({})})}),`
`,a(ue,{story:"Default"})]})}}const F=ne.bind({});F.storyName="Default";F.argTypes=ie;F.args={shape:"square",title:"Overdose Mortality Rates",content:"of overdoses resulted in death.",subtext:"This data is an example and does not reflect actual averages",orientation:"horizontal",data:[{"Resulted in Death":250,"Number of Overdoses":600,state:"Alabama",Year:"2010"},{"Resulted in Death":16,"Number of Overdoses":80,state:"Alaska",Year:"2008"},{"Resulted in Death":19,"Number of Overdoses":100,state:"Alaska",Year:"2010"},{"Resulted in Death":93,"Number of Overdoses":400,state:"Alaska",Year:"2012"},{"Resulted in Death":82,"Number of Overdoses":400,state:"Arizona",Year:"2010"}],filters:[],fontSize:null,overallFontSize:"medium",dataColumn:"Resulted in Death",dataFunction:"Sum",dataConditionalColumn:"",dataConditionalOperator:null,dataConditionalComparate:"",customDenom:!0,dataDenom:null,dataDenomColumn:"Number of Overdoses",dataDenomFunction:"Sum",prefix:"",suffix:"%",roundToPlace:0,nodeWidth:10,nodeSpacer:2,theme:"blue"};F.parameters={storySource:{source:`args => <CdcWaffleChart config={{ ...args
}} />`}};const T={title:"Visualizations/Waffle Chart",component:A,tags:["stories-mdx"],includeStories:["defaultStory"]};T.parameters=T.parameters||{};T.parameters.docs={...T.parameters.docs||{},page:qe};const xa=["Template","types","defaultStory"];export{ne as Template,xa as __namedExportsOrder,T as default,F as defaultStory,ie as types};
//# sourceMappingURL=WaffleChart.stories-16bf8e34.js.map
