{"version":3,"file":"InputSelect-c989da31.js","sources":["../../packages/core/components/input/InputSelect.jsx"],"sourcesContent":["import React, { useRef, useEffect, useState, memo } from 'react'\nimport PropTypes from 'prop-types'\n\n// Hooks\nimport { useVisConfig } from '../../hooks/store/useVisConfig'\n\n// Helpers\nimport { getConfigKeyValue } from '../../helpers/configHelpers'\n\n// Components\nimport Label from '../element/Label'\n\n// Styles\nimport '../../styles/v2/components/input/index.scss'\n\nconst InputSelect = (\n  {\n    label,\n    options = [ '' ],\n    initial,\n    initialDisabled,\n    initialSnap,\n    required,\n    tooltip,\n\n    configField,\n    value: inlineValue = '',\n    onChange, className, ...attributes\n  }\n) => {\n  // Store Selectors\n  const { config, updateVisConfigField } = useVisConfig()\n\n  const [ value, setValue ] = useState()\n\n  const inputRef = useRef(null)\n\n  // Get initial value\n  const configFieldValue = configField && getConfigKeyValue(configField, config)\n\n  // Check initial value\n  const valueExistsOnConfig = !!(configFieldValue && typeof configFieldValue !== undefined)\n\n  // Set initial value\n  useEffect(() => {\n    if (valueExistsOnConfig) {\n      configFieldValue !== value && setValue(configFieldValue)\n    } else {\n      setValue(inlineValue)\n    }\n  }, [ valueExistsOnConfig ])\n\n  useEffect(() => {\n    // If either no initial option is set, or the option selected is not an initial value\n    if (!isInitial(value)) {\n      // Update a config field value, if configField array was supplied\n      if (configField && value !== configFieldValue) {\n        updateVisConfigField(configField, value)\n      }\n    }\n  }, [ configField, value ])\n\n  const isInitial = (checkValue) => {\n    return initial && (checkValue === initial || checkValue === '')\n  }\n\n  let optionsJsx = null\n\n  // Generate the select dropdown options\n  if (options instanceof Array) {\n    // Handle an Array entry\n    optionsJsx = options.map((option, index) => <option value={option} key={index}>{option}</option>)\n  } else if (options === Object(options)) {\n    // Validate that the remaining non-array value is an object type\n    // and handle an Object entry using its key/value pairs.\n    let optionsArr = []\n    for (let [ optionKey, optionValue ] of Object.entries(options)) {\n      optionsArr.push(<option value={optionKey} key={optionKey}>{optionValue}</option>)\n    }\n    optionsJsx = optionsArr\n  }\n\n  // Add custom, initial option\n  if (optionsJsx && (initial || initialDisabled)) optionsJsx.unshift(\n    <option value=\"\" hidden={(initialDisabled && value !== '') || null} disabled={initialDisabled || null} key=\"default\">{initial}</option>\n  )\n\n  // Handle updating of config data when select option is changed\n  const onChangeHandler = (e) => {\n    let eventValue = e.target.value\n    setValue(eventValue)\n\n    // Run any additional onChange functions supplied\n    if (onChange) onChange(e)\n\n    // Resets selected option to default if initialSnap is set\n    // Used for multiple select options to add one, snap back to start, and allow another option to be selected;\n    // Examples: adding filtered data keys, attaching multiple data sets, etc.\n    if (initialSnap && isInitial('')) setValue('')\n  }\n\n  return (\n    <>\n      {label &&\n        <Label tooltip={tooltip} onClick={() => {\n          inputRef.current.focus()\n          inputRef.current.click()\n        }}>\n          {label}\n        </Label>\n      }\n      {optionsJsx ?\n        <select\n          className={`cove-input${required && (value === undefined || value === '') ? ' cove-input--error' : ''}${className ? ' ' + className : ''}`}\n          value={value ?? ''} onChange={(e) => onChangeHandler(e)} {...attributes}\n          ref={inputRef}\n        >\n          {optionsJsx.map(option => (option))}\n        </select> :\n        <p className=\"mb-2\"><i>No options are available...</i></p>\n      }\n    </>\n  )\n}\n\nInputSelect.propTypes = {\n  /** Add label to the input field */\n  label: PropTypes.string,\n  /** Add a tooltip to describe the input's usage; JSX markup can also be supplied */\n  tooltip: PropTypes.oneOfType([\n    PropTypes.object,\n    PropTypes.string\n  ]),\n  /** Supply an array of options, or an object of key/value pairs to use as options */\n  options: PropTypes.oneOfType([\n    PropTypes.array,\n    PropTypes.object\n  ]),\n  /** Prepend a default initial option */\n  initial: PropTypes.string,\n  /** Allow the initial option to display, but disable selection of the initial option */\n  initialDisabled: PropTypes.bool,\n  /** Snap returns to the initial value, regardless of previous selection; helpful when triggering onChange() events\n   * when an option is selected (like adding a filter from a list), and the select is expected to be used multiple times **/\n  initialSnap: PropTypes.bool,\n  /** Mark the input as required; will set error style while value is undefined */\n  required: PropTypes.bool,\n  /** Supply a reference to the config key this input connects to, if any.<br/><br/>\n   * **String**<br/>\n   * `configField=\"title\"` will connect to the `config.title` value.<br/><br/>\n   * **Array**<br/>\n   * `configField={[ 'componentStyle', 'shadow' ]}` will connect to the `config.componentStyle.shadow` value. <br/><br/>\n   * See [setConfigKeyValue](https://cdcgov.github.io/cdc-open-viz/?path=/docs/helpers-confighelpers-setconfigkeyvalue--docs) for more details. */\n  configField: PropTypes.oneOfType([ PropTypes.string, PropTypes.array ]),\n  /** Function to call when the input is changed */\n  onChange: PropTypes.func,\n}\n\nexport default memo(InputSelect)\n"],"names":["InputSelect","label","options","initial","initialDisabled","initialSnap","required","tooltip","configField","inlineValue","onChange","className","attributes","config","updateVisConfigField","useVisConfig","value","setValue","useState","inputRef","useRef","configFieldValue","getConfigKeyValue","valueExistsOnConfig","useEffect","isInitial","checkValue","optionsJsx","option","index","jsx","optionsArr","optionKey","optionValue","onChangeHandler","eventValue","jsxs","Fragment","Label","PropTypes","InputSelect$1","memo"],"mappings":"uSAeA,MAAAA,EAAA,CACA,CACA,MAAAC,EACA,QAAAC,EAAA,CAAA,EAAA,EACA,QAAAC,EACA,gBAAAC,EACA,YAAAC,EACA,SAAAC,EACA,QAAAC,EAEA,YAAAC,EACA,MAAAC,EAAA,GACA,SAAAC,EAAA,UAAAC,EAAA,GAAAC,CACA,IACA,CAEA,KAAA,CAAA,OAAAC,EAAA,qBAAAC,CAAA,EAAAC,EAAA,EAEA,CAAAC,EAAAC,CAAA,EAAAC,EAAA,SAAA,EAEAC,EAAAC,SAAA,IAAA,EAGAC,EAAAb,GAAAc,EAAAd,EAAAK,CAAA,EAGAU,EAAA,CAAA,EAAAF,GAAA,OAAAA,IAAA,QAGAG,EAAAA,UAAA,IAAA,CACAD,EACAF,IAAAL,GAAAC,EAAAI,CAAA,EAEAJ,EAAAR,CAAA,CACA,EACA,CAAAc,CAAA,CAAA,EAEAC,EAAAA,UAAA,IAAA,CAEAC,EAAAT,CAAA,GAEAR,GAAAQ,IAAAK,GACAP,EAAAN,EAAAQ,CAAA,CAEA,EACA,CAAAR,EAAAQ,CAAA,CAAA,EAEA,MAAAS,EAAAC,GACAvB,IAAAuB,IAAAvB,GAAAuB,IAAA,IAGA,IAAAC,EAAA,KAGA,GAAAzB,aAAA,MAEAyB,EAAAzB,EAAA,IAAA,CAAA0B,EAAAC,IAAAC,EAAA,SAAA,CAAA,MAAAF,EAAA,SAAAA,CAAA,EAAAC,CAAA,CAAA,UACA3B,IAAA,OAAAA,CAAA,EAAA,CAGA,IAAA6B,EAAA,CAAA,EACA,OAAA,CAAAC,EAAAC,CAAA,IAAA,OAAA,QAAA/B,CAAA,EACA6B,EAAA,KAAAD,EAAA,SAAA,CAAA,MAAAE,EAAA,SAAAC,GAAAD,CAAA,CAAA,EAEAL,EAAAI,CACA,CAGAJ,IAAAxB,GAAAC,IAAAuB,EAAA,QACAG,EAAA,SAAA,CAAA,MAAA,GAAA,OAAA1B,GAAAY,IAAA,IAAA,KAAA,SAAAZ,GAAA,KAAA,YAAA,SAAA,CAAA,EAIA,MAAA8B,EAAA,GAAA,CACA,IAAAC,EAAA,EAAA,OAAA,MACAlB,EAAAkB,CAAA,EAGAzB,GAAAA,EAAA,CAAA,EAKAL,GAAAoB,EAAA,EAAA,GAAAR,EAAA,EAAA,CAAA,EAGA,OAEAmB,EAAAC,EAAA,CAAA,SAAA,CAAApC,GACA6B,EAAAQ,EAAA,CAAA,QAAA/B,EAAA,QAAA,IAAA,CACAY,EAAA,QAAA,QACAA,EAAA,QAAA,OAAA,EAEA,SACAlB,EAAA,EAEA0B,EACAG,EAAA,SAAA,CACA,UAAA,aAAAxB,IAAAU,IAAA,QAAAA,IAAA,IAAA,qBAAA,KAAAL,EAAA,IAAAA,EAAA,KACA,MAAAK,GAAA,GAAA,SAAA,GAAAkB,EAAA,CAAA,EAAA,GAAAtB,EACA,IAAAO,EAEA,SAAAQ,EAAA,IAAAC,GAAAA,CAAA,CAAA,CACA,IACA,IAAA,CAAA,UAAA,OAAA,SAAAE,EAAA,IAAA,CAAA,uCAAA,CAAA,CAAA,CAEA,CAAA,CAAA,CAEA,EAEA9B,EAAA,UAAA,CAEA,MAAAuC,EAAA,OAEA,QAAAA,EAAA,UAAA,CACAA,EAAA,OACAA,EAAA,MAAA,CACA,EAEA,QAAAA,EAAA,UAAA,CACAA,EAAA,MACAA,EAAA,MAAA,CACA,EAEA,QAAAA,EAAA,OAEA,gBAAAA,EAAA,KAGA,YAAAA,EAAA,KAEA,SAAAA,EAAA,KAOA,YAAAA,EAAA,UAAA,CAAAA,EAAA,OAAAA,EAAA,KAAA,CAAA,EAEA,SAAAA,EAAA,IACA,EAEA,MAAAC,EAAAC,OAAAzC,CAAA;"}